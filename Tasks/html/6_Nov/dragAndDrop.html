<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Drag and Drop</title>
  <link rel="stylesheet" href="/./dist/output.css" />
</head>

<body class="bg-gray-100">
  <div class="flex flex-col gap-10 items-center justify-center h-screen">
    <div>
      <input type="text" placeholder="Enter Your Task" class="flex h-10 w-80 p-2 rounded-md shadow-lg" id="js_input" />
    </div>
    <div id="js_container" class="flex gap-10 text-white">
      <div id="js_assigned" class="rounded-lg bg-white p-3 w-80 h-96 overflow-auto shadow-lg">
        <h2 class="font-semibold text-lg text-black py-2 border-b-2 border-b-black">
          Assigned Tasks
        </h2>
        <ul class="pt-4 mt-2 space-y-5" id="assignedUl">
        </ul>
      </div>
      <div id="js_pending" class="rounded-lg bg-white p-3 w-80 h-96 overflow-auto shadow-lg">
        <h2 class="font-semibold text-lg text-black p-2 border-b-2 border-b-black">
          Pending Tasks
        </h2>
        <ul class="pt-4 mt-2 space-y-5" id="pendingUl"></ul>
      </div>
      <div id="js_completed" class="border-2 rounded-lg bg-white p-3 w-80 h-96 overflow-auto shadow-lg">
        <h2 class="text-lg p-2 border-b-2 text-black border-b-black font-semibold">
          Completed Tasks
        </h2>
        <ul class="pt-4 mt-2 space-y-5" id="completedUl"></ul>
      </div>
    </div>
  </div>
  <script>
    let inputt = document.getElementById("js_input");
    let taskLi = document.getElementsByClassName("taskLists");
    let assigned = document.getElementById("js_assigned");
    let pending = document.getElementById("js_pending");
    let completed = document.getElementById("js_completed");
    let ulAssigned = document.getElementById("assignedUl");
    let ulPending = document.getElementById("pendingUl");
    let ulCompleted = document.getElementById("completedUl");
    let button = document.getElementById("js_button");
    let svgDel =
      '<svg class="delSvg w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="none"><path d="M7 3H9C9 2.44772 8.55228 2 8 2C7.44772 2 7 2.44772 7 3ZM6 3C6 1.89543 6.89543 1 8 1C9.10457 1 10 1.89543 10 3H14C14.2761 3 14.5 3.22386 14.5 3.5C14.5 3.77614 14.2761 4 14 4H13.4364L12.2313 12.8378C12.0624 14.0765 11.0044 15 9.75422 15H6.24578C4.99561 15 3.93762 14.0765 3.76871 12.8378L2.56355 4H2C1.72386 4 1.5 3.77614 1.5 3.5C1.5 3.22386 1.72386 3 2 3H6ZM7 6.5C7 6.22386 6.77614 6 6.5 6C6.22386 6 6 6.22386 6 6.5V11.5C6 11.7761 6.22386 12 6.5 12C6.77614 12 7 11.7761 7 11.5V6.5ZM9.5 6C9.22386 6 9 6.22386 9 6.5V11.5C9 11.7761 9.22386 12 9.5 12C9.77614 12 10 11.7761 10 11.5V6.5C10 6.22386 9.77614 6 9.5 6Z" fill="currentColor"></path></svg>';

    let deleteIcons = document.getElementsByClassName("delSvg");
    function createSVGElement(svgMarkup) {
      let div = document.createElement("div");
      div.innerHTML = svgMarkup.trim();
      let deleteButton = div.firstChild;

      deleteButton.addEventListener("click", () => {
        deleteTask(deleteButton);
      });

      return deleteButton;
    }

    function deleteTask(deleteButton) {
      let parentLi = deleteButton.closest('.taskLists');
      parentLi.remove();
      saveToLocalStorage();
    }

    // Function to save data to localStorag7
    function saveToLocalStorage() {
      localStorage.setItem("assignedTasks", ulAssigned.innerHTML);
      localStorage.setItem("pendingTasks", ulPending.innerHTML);
      localStorage.setItem("completedTasks", ulCompleted.innerHTML);
    }

    // Function to retrieve data from localStorage
    function loadFromLocalStorage() {
      ulAssigned.innerHTML = localStorage.getItem("assignedTasks");
      ulPending.innerHTML = localStorage.getItem("pendingTasks");
      ulCompleted.innerHTML = localStorage.getItem("completedTasks");
    }

    let selected;

    function dragLists(e) {
      selected = e.target;
      console.log(selected);
      document.addEventListener("drop", () => {
        saveToLocalStorage();
      });
      document.addEventListener("dragover", (e) => {
        e.preventDefault();
      });
      pending.addEventListener("drop", (e) => {
        ulPending.appendChild(selected);
        selected.classList.remove("bg-blue-700");
        selected.classList.remove("text-gray-700");
        selected.classList.remove("line-through");
        selected.classList.add("bg-green-800");
      });
      assigned.addEventListener("drop", (e) => {
        ulAssigned.appendChild(selected);
        selected.classList.remove("bg-gray-200");
        selected.classList.remove("bg-green-800");
        selected.classList.remove("line-through");
        selected.classList.remove("text-gray-700");
        selected.classList.add("bg-blue-700");
      });
      completed.addEventListener("drop", (e) => {
        ulCompleted.appendChild(selected);
        selected.classList.remove("bg-blue-700");
        selected.classList.remove("bg-green-800");
        selected.classList.remove("text-white");
        selected.classList.add("text-gray-700");
        selected.classList.add("bg-gray-200");
        selected.classList.add("line-through");
      });
    }

    function addTask() {
      if (inputt.value.trim() !== "") {
        let li = document.createElement("li");
        li.className =
          "taskLists flex justify-between bg-blue-700 rounded-md text-white font-medium p-2 items-center";
        li.draggable = true;
        li.innerHTML = inputt.value;

        let deleteButton = createSVGElement(svgDel);
        li.appendChild(deleteButton);

        li.addEventListener("dragstart", dragLists);
        ulAssigned.appendChild(li);
        saveToLocalStorage();
        inputt.value = "";
      }
    }

    function attachDeleteEvent() {
      let deleteButtons = document.querySelectorAll(".taskLists .delSvg");

      deleteButtons.forEach((deleteButton) => {
        deleteButton.addEventListener("click", () => {
          deleteTask(deleteButton);
        });
      });
    }

    function loopOnLists(e) {
      inputt.addEventListener("keydown", (event) => {
        if (event.key === "Enter") {
          addTask();
        }
      });
      for (list of taskLi) {
        list.addEventListener("dragstart", dragLists);
      }
    }
    window.addEventListener("load", (e) => {
      loopOnLists(e);
      saveToLocalStorage();
      let classDelete = document.getElementsByClassName("delSvg");
      console.log(classDelete[0]);
      attachDeleteEvent();
    });
    if (localStorage.getItem("assignedTasks")) {
      loadFromLocalStorage();
    }
  </script>
</body>

</html>